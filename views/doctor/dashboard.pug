extends ../common/layout

block style_links
  link(rel='stylesheet', href='/stylesheets/doctor/dashboard.css')

block scripts
  script(src="/javascripts/doctor/dashboard.js")

block content
    div#doc_main_container.container
        h2 Dr. #{fullName}
        hr
        include ../common/alert.pug
        form#filter_appointments_form
            div.container_flex
                input#clinic_input.flex_3(
                    list='doctor_clinics_list', 
                    class="form-control",
                    name="clinic_name", 
                    placeholder="Clinic/Hospital" )
                datalist#doctor_clinics_list
                    for clinic in clinics
                        option(value=clinic[1])
                input#history_btn(
                    type='submit'
                    class='btn btn-primary'
                    value='Filter' )
        div#appointments_body
            div
                h4 Appointment Requests (new):
                div.appointments_list.appointments_new
                    for app in appointments
                        if (app[6] == 'new')
                            div.row
                                div.col-sm-1 # #{app[0]}
                                div.col-sm-3 #{app[2]}, #{app[1]}
                                div.col-sm-3 #{app[3]}, #{app[4]} to #{app[5]}
                                div.col-sm-5
                                    input(type="button" class="btn btn-primary appointment_buttons" value="Accept" onclick="statusChange("+app[0]+", 'accepted')")
                                    input(type="button" class="btn btn-danger appointment_buttons" value="Decline" onclick="statusChange("+app[0]+", 'declined')")
                                    input(type="button" class="btn btn-primary appointment_buttons" value="Details")
            div
                div
                    h4 Current Appointments:
                    -var today = new Date()
                    -today.setDate(today.getDate())
                    -var nothing = true    // check if there exists such appointments have date today
                    h5 Today, #{today.getDate()}/ #{today.getMonth()+1}
                    div.appointments_list.appointments_today
                        for app in appointments
                            -var datee = new Date(app[3])
                            if (app[6] == 'accepted' && today.getDate() == datee.getDate() && today.getMonth() == datee.getMonth() && today.getYear() == datee.getYear())
                                -nothing = false
                                div.row
                                    div.col-sm-1 # #{app[0]}
                                    div.col-sm-3 #{app[2]}, #{app[1]}
                                    div.col-sm-3 #{app[3]}, #{app[4]} to #{app[5]}
                                    div.col-sm-5
                                        input(type="button" class="btn btn-primary appointment_buttons" value="Done"  onclick="statusChange("+app[0]+", 'done')")
                                        input(type="button" class="btn btn-primary appointment_buttons" value="Details")
                        if (nothing)
                            div.text_centered Nothing to show.
                div
                    -var tomorrow = new Date()
                    -tomorrow.setDate(today.getDate()+1)
                    -var nothing = true;    // check if there exists such appointments have date tomorrow
                    h5 Tomorrow, #{tomorrow.getDate()}/ #{tomorrow.getMonth()+1}
                    div.appointments_list.appointments_tomorrow
                        for app in appointments
                            -var datee = new Date(app[3])
                            if (app[6] == 'accepted'  && tomorrow.getDate() == datee.getDate() && tomorrow.getMonth() == datee.getMonth() && tomorrow.getYear() == datee.getYear())
                                -nothing = false;
                                div.row
                                    div.col-sm-1 # #{app[0]}
                                    div.col-sm-3 #{app[2]}, #{app[1]}
                                    div.col-sm-3 #{app[3]}, #{app[4]} to #{app[5]}
                                    div.col-sm-5
                                        input(type="button" class="btn btn-primary appointment_buttons" value="Details")
                        if (nothing)
                            div.text_centered Nothing to show.
                div 
                    -var nothing = true;
                    h5 Later
                    div.appointments_list.appointments_later
                        for app in appointments
                            -var datee = new Date(app[3])
                            if (app[6] == 'accepted' && datee > tomorrow)
                                -nothing = false
                                div.row
                                    div.col-sm-1 # #{app[0]}
                                    div.col-sm-3 #{app[2]}, #{app[1]}
                                    div.col-sm-3 #{app[3]}, #{app[4]} to #{app[5]}
                                    div.col-sm-5
                                        input(type="button" class="btn btn-primary appointment_buttons" value="Details")
                        if (nothing)
                            div.text_centered Nothing to show.